<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>Sim's Blog</title>
  <!-- 
    <link rel = "stylesheet" type = "text/css" href = "style.css">    
    <link rel = "stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  -->
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PZHMKJQ');</script>
<!-- End Google Tag Manager -->
    
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-192865228-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-192865228-2');
</script>

  </head>
  <body>
    <div>
      <button id="re">새로고침</button>
    </div>
    <h1 id="test">TEST</h1>
    <h2 id="test2"></h2>
    <button id="login">로그인</button>
    <button id="after">로그인 이후</button>
    
    <div>
      <h2 class="ua"></h2>
    </div>
    
  <script>
              
    var ua = navigator.userAgent;
    document.querySelector(".ua").innerText = ua;
    
    function getCookie(name) {
      var nameEQ = name + "=";
      var ca = document.cookie.split(';');
      for(var i=0;i < ca.length;i++) {
          var c = ca[i];
          while (c.charAt(0)==' ') c = c.substring(1,c.length);
          if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
      }
      return null;
    }
    
    //새로고침
    
    document.querySelector("#re").addEventListener("click", function(){
      location.reload();
    })
    
    // 쿠키 값으로 텍스트 변경
    document.querySelector("#test").innerText = getCookie("_ga");
    
    //App_Instance_ID 가 네이티브에서 제대로 넘어오는지 확인
    document.querySelector("#test2").innerText = getCookie("app_instance_id");
    

    function logEvent(name, params) {
      if (!name) {
        return;
      }

      if (window.AnalyticsWebInterface) {
        // Call Android interface
        window.AnalyticsWebInterface.logEvent(name, JSON.stringify(params));
      } else if (window.webkit
          && window.webkit.messageHandlers
          && window.webkit.messageHandlers.firebase) {
        // Call iOS interface
        var message = {
          command: 'logEvent',
          name: name,
          parameters: params
        };
        window.webkit.messageHandlers.firebase.postMessage(message);
      } else {
        // No Android or iOS interface found
        console.log("No native APIs found.");
      }
    }

    function setUserProperty(name, value) {
      if (!name || !value) {
        return;
      }

      if (window.AnalyticsWebInterface) {
        // Call Android interface
        window.AnalyticsWebInterface.setUserProperty(name, value);
      } else if (window.webkit
          && window.webkit.messageHandlers
          && window.webkit.messageHandlers.firebase) {
        // Call iOS interface
        var message = {
          command: 'setUserProperty',
          name: name,
          value: value
       };
        window.webkit.messageHandlers.firebase.postMessage(message);
      } else {
        // No Android or iOS interface found
        console.log("No native APIs found.");
      }
    }
    document.querySelector("#test").addEventListener("click", function(){
      console.log("event1")
      logEvent("event1", {foo:"bar"})
    })
    
    document.querySelector("#login").addEventListener("click", function(){
      logEvent("login", {login_test:"false"})
      setUserProperty("login_id", "20220704");
    })
    
    document.querySelector("#after").addEventLitener("click", function(){
      logEvent("after", {login_test:"true"})
    })
  </script>
  </body>  
</html>
